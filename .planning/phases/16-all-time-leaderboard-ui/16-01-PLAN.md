---
phase: 16-all-time-leaderboard-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - MrFunnyJokes/MrFunnyJokes/Models/FirestoreModels.swift
  - MrFunnyJokes/MrFunnyJokes/Services/FirestoreService.swift
  - MrFunnyJokes/MrFunnyJokes/ViewModels/AllTimeRankingsViewModel.swift
  - MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/AllTimeTopTenCarouselView.swift
  - MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/AllTimeTopTenDetailView.swift
  - MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/RankedJokeCard.swift
  - MrFunnyJokes/MrFunnyJokes/Views/JokeFeedView.swift
  - MrFunnyJokes/MrFunnyJokes.xcodeproj/project.pbxproj
autonomous: true

must_haves:
  truths:
    - "All UI that previously showed 'Monthly Top 10' now shows 'All-Time Top 10'"
    - "Leaderboard displays rankings sourced from the all-time Cloud Function data (weekly_rankings/all_time document)"
    - "No references to 'Monthly', date ranges, or week periods remain in the app UI"
    - "No 'Monthly' or 'monthly' string references remain in Swift source files (excluding comments about backend collection name)"
  artifacts:
    - path: "MrFunnyJokes/MrFunnyJokes/Models/FirestoreModels.swift"
      provides: "WeeklyRankings struct with optional weekStart/weekEnd"
      contains: "let weekStart: Date?"
    - path: "MrFunnyJokes/MrFunnyJokes/Services/FirestoreService.swift"
      provides: "fetchAllTimeRankings reading from all_time document"
      contains: "func fetchAllTimeRankings"
    - path: "MrFunnyJokes/MrFunnyJokes/ViewModels/AllTimeRankingsViewModel.swift"
      provides: "AllTimeRankingsViewModel class"
      contains: "class AllTimeRankingsViewModel"
    - path: "MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/AllTimeTopTenCarouselView.swift"
      provides: "AllTimeTopTenCarouselView with All-Time Top 10 header"
      contains: "All-Time Top 10"
    - path: "MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/AllTimeTopTenDetailView.swift"
      provides: "AllTimeTopTenDetailView with no date range subtitle"
      contains: "All-Time Top 10"
    - path: "MrFunnyJokes/MrFunnyJokes/Views/JokeFeedView.swift"
      provides: "Feed view using AllTimeRankingsViewModel and AllTimeTopTen views"
      contains: "AllTimeRankingsViewModel"
  key_links:
    - from: "MrFunnyJokes/MrFunnyJokes/ViewModels/AllTimeRankingsViewModel.swift"
      to: "MrFunnyJokes/MrFunnyJokes/Services/FirestoreService.swift"
      via: "fetchAllTimeRankings() call"
      pattern: "firestoreService\\.fetchAllTimeRankings"
    - from: "MrFunnyJokes/MrFunnyJokes/Services/FirestoreService.swift"
      to: "Firestore weekly_rankings/all_time document"
      via: "hardcoded all_time document ID"
      pattern: 'document\("all_time"\)'
    - from: "MrFunnyJokes/MrFunnyJokes/Views/JokeFeedView.swift"
      to: "MrFunnyJokes/MrFunnyJokes/ViewModels/AllTimeRankingsViewModel.swift"
      via: "@StateObject instantiation"
      pattern: "AllTimeRankingsViewModel\\(\\)"
---

<objective>
Rename all "Monthly Top 10" references to "All-Time Top 10" across the entire iOS app, rewire the data source from weekly document to the all_time document, and rename files/folders from MonthlyTopTen to AllTimeTopTen.

Purpose: Complete the v1.1.0 milestone by connecting the UI to the all-time rankings data produced by the Phase 13 Cloud Function, replacing the defunct monthly/weekly ranking concept.
Output: All leaderboard UI reads from weekly_rankings/all_time, shows "All-Time Top 10", and no "Monthly" references remain in Swift source.
</objective>

<execution_context>
@/Users/brianvanaski/.claude/get-shit-done/workflows/execute-plan.md
@/Users/brianvanaski/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-all-time-leaderboard-ui/16-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Data layer changes, filesystem renames, and pbxproj updates</name>
  <files>
    MrFunnyJokes/MrFunnyJokes/Models/FirestoreModels.swift
    MrFunnyJokes/MrFunnyJokes/Services/FirestoreService.swift
    MrFunnyJokes/MrFunnyJokes/ViewModels/MonthlyRankingsViewModel.swift -> AllTimeRankingsViewModel.swift
    MrFunnyJokes/MrFunnyJokes/Views/MonthlyTopTen/ -> AllTimeTopTen/
    MrFunnyJokes/MrFunnyJokes.xcodeproj/project.pbxproj
  </files>
  <action>
    **Step 1: Model schema fix (FirestoreModels.swift)**

    In `MrFunnyJokes/MrFunnyJokes/Models/FirestoreModels.swift`, make `weekStart` and `weekEnd` optional in the `WeeklyRankings` struct (lines 166-167):
    - Change `let weekStart: Date` to `let weekStart: Date?`
    - Change `let weekEnd: Date` to `let weekEnd: Date?`
    - Update the doc comment on line 162-163 from "Represents a week's rankings" to "Represents rankings from the Firestore 'weekly_rankings' collection". Update the second comment line from "Document ID format: '2024-W03' (ISO week format)" to "Document ID: 'all_time' for cumulative rankings".

    Do NOT rename the `WeeklyRankings` struct itself -- keeping it matching the Firestore collection name per accepted tech debt decision.

    **Step 2: Service layer rewire (FirestoreService.swift)**

    In `MrFunnyJokes/MrFunnyJokes/Services/FirestoreService.swift`:
    - Rename `fetchWeeklyRankings()` (line 474) to `fetchAllTimeRankings()`
    - Replace the body: remove `let weekId = getCurrentWeekId()` and change `document(weekId)` to `document("all_time")`
    - Update the doc comment (line 472-473) from "Fetches the current week's rankings" to "Fetches the all-time rankings"
    - Update the MARK comment on line 446 from "Rating Events (for Weekly Top 10)" to "Rating Events & Rankings"
    - Remove the `getCurrentWeekDateRange()` method entirely (lines 522-535) -- it has no callers after this change
    - CRITICAL: Do NOT remove `getCurrentWeekId()` (lines 510-520) -- it is still used by `logRatingEvent()` on line 455

    **Step 3: Filesystem renames via git mv**

    Run these git mv commands in order:
    ```
    git mv MrFunnyJokes/MrFunnyJokes/ViewModels/MonthlyRankingsViewModel.swift MrFunnyJokes/MrFunnyJokes/ViewModels/AllTimeRankingsViewModel.swift
    git mv MrFunnyJokes/MrFunnyJokes/Views/MonthlyTopTen/MonthlyTopTenCarouselView.swift MrFunnyJokes/MrFunnyJokes/Views/MonthlyTopTen/AllTimeTopTenCarouselView.swift
    git mv MrFunnyJokes/MrFunnyJokes/Views/MonthlyTopTen/MonthlyTopTenDetailView.swift MrFunnyJokes/MrFunnyJokes/Views/MonthlyTopTen/AllTimeTopTenDetailView.swift
    git mv MrFunnyJokes/MrFunnyJokes/Views/MonthlyTopTen MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen
    ```

    Note: Rename files within MonthlyTopTen BEFORE renaming the folder itself.

    **Step 4: Update project.pbxproj**

    In `MrFunnyJokes/MrFunnyJokes.xcodeproj/project.pbxproj`, do string replacements (do NOT change any UUIDs):
    - Replace all `MonthlyTopTenDetailView.swift` with `AllTimeTopTenDetailView.swift` (appears on lines 56, 141, 351, 477)
    - Replace all `MonthlyTopTenCarouselView.swift` with `AllTimeTopTenCarouselView.swift` (appears on lines 57, 140, 350, 478)
    - Replace all `MonthlyRankingsViewModel.swift` with `AllTimeRankingsViewModel.swift` (appears on lines 59, 142, 260, 491)
    - Replace `path = MonthlyTopTen;` with `path = AllTimeTopTen;` (line 353)
    - Replace `MonthlyTopTen */` (group comment on line 239) with `AllTimeTopTen */`

    Use replace_all for each string replacement to catch all occurrences.
  </action>
  <verify>
    1. Run: `grep -r "MonthlyTopTen\|MonthlyRankings" MrFunnyJokes/MrFunnyJokes.xcodeproj/project.pbxproj` -- should return nothing
    2. Run: `ls MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/` -- should show AllTimeTopTenCarouselView.swift, AllTimeTopTenDetailView.swift, RankedJokeCard.swift
    3. Run: `ls MrFunnyJokes/MrFunnyJokes/ViewModels/AllTimeRankingsViewModel.swift` -- should exist
    4. Run: `grep "fetchAllTimeRankings" MrFunnyJokes/MrFunnyJokes/Services/FirestoreService.swift` -- should find the renamed method
    5. Run: `grep "getCurrentWeekId" MrFunnyJokes/MrFunnyJokes/Services/FirestoreService.swift` -- should still exist (used by logRatingEvent)
    6. Run: `grep "getCurrentWeekDateRange" MrFunnyJokes/MrFunnyJokes/Services/FirestoreService.swift` -- should return nothing (removed)
  </verify>
  <done>
    WeeklyRankings model decodes all_time documents (optional weekStart/weekEnd). FirestoreService reads from "all_time" document via fetchAllTimeRankings(). All files renamed from Monthly to AllTime on filesystem and in pbxproj. getCurrentWeekId() preserved for logRatingEvent().
  </done>
</task>

<task type="auto">
  <name>Task 2: Rename all Monthly references in Swift source to All-Time</name>
  <files>
    MrFunnyJokes/MrFunnyJokes/ViewModels/AllTimeRankingsViewModel.swift
    MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/AllTimeTopTenCarouselView.swift
    MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/AllTimeTopTenDetailView.swift
    MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/RankedJokeCard.swift
    MrFunnyJokes/MrFunnyJokes/Views/JokeFeedView.swift
  </files>
  <action>
    **Step 1: AllTimeRankingsViewModel.swift (was MonthlyRankingsViewModel.swift)**

    - Rename class from `MonthlyRankingsViewModel` to `AllTimeRankingsViewModel`
    - Remove the `@Published var monthDateRange: String = ""` property (line 14)
    - In `loadRankings()`: change `firestoreService.fetchWeeklyRankings()` to `firestoreService.fetchAllTimeRankings()`
    - In `loadRankings()`: remove the line `monthDateRange = formatDateRange(start: rankings.weekStart, end: rankings.weekEnd)` (line 79)
    - Remove the entire `formatDateRange(start:end:)` method (lines 92-115)
    - Update the error print from "Failed to load monthly rankings" to "Failed to load all-time rankings"
    - Update the comment on line 46 from "Fetch monthly rankings" to "Fetch all-time rankings"

    **Step 2: AllTimeTopTenCarouselView.swift (was MonthlyTopTenCarouselView.swift)**

    Rename ALL "Monthly" structs and references:
    - Doc comment line 3: "Monthly Top 10" -> "All-Time Top 10"
    - `MonthlyTopTenCarouselView` -> `AllTimeTopTenCarouselView` (line 4, line 134)
    - `MonthlyRankingsViewModel` -> `AllTimeRankingsViewModel` (line 5, line 136)
    - `MonthlyTop10Header` -> `AllTimeTop10Header` (lines 11, 49, 149, 162)
    - `MonthlyTopTenCardSkeleton` -> `AllTimeTopTenCardSkeleton` (lines 19, 20, 110, 152, 153)
    - `MonthlyTopTenCard` -> `AllTimeTopTenCard` (lines 22, 32, 71/MARK comment, 74, 165, 171)
    - UI text: `Text("Monthly Top 10")` on line 55 -> `Text("All-Time Top 10")`

    Use replace_all for each struct name to catch all occurrences including previews.

    **Step 3: AllTimeTopTenDetailView.swift (was MonthlyTopTenDetailView.swift)**

    - Doc comment line 3: "Monthly Top 10" -> "All-Time Top 10"
    - `MonthlyTopTenDetailView` -> `AllTimeTopTenDetailView` (lines 4, 142)
    - `MonthlyRankingsViewModel` -> `AllTimeRankingsViewModel` (lines 5, 143)
    - Remove the entire `dateRange` computed property (lines 10-41) -- no date range for all-time
    - In the body, remove the `Text(dateRange)` block (lines 47-51) that shows the date range subtitle
    - Change `.navigationTitle("Monthly Top 10")` to `.navigationTitle("All-Time Top 10")` (line 88)

    **Step 4: RankedJokeCard.swift**

    - Update the doc comment on line 3: "Monthly Top 10" -> "All-Time Top 10"
    - No struct name changes needed (RankedJokeCard has no "Monthly" in the name)

    **Step 5: JokeFeedView.swift**

    - `MonthlyRankingsViewModel()` -> `AllTimeRankingsViewModel()` (line 5)
    - Comment line 8: "Monthly Top 10" -> "All-Time Top 10"
    - `monthlyTopTenDestination` -> `allTimeTopTenDestination` (lines 9, 85, 153)
    - Comment line 32: "Monthly Top 10" -> "All-Time Top 10"
    - `showMonthlyTopTen` -> `showAllTimeTopTen` (lines 33, 81)
    - `MonthlyTopTenCarouselView` -> `AllTimeTopTenCarouselView` (line 82)
    - Comment line 80: "Monthly Top 10" -> "All-Time Top 10"
    - `MonthlyTopTenDetailView` -> `AllTimeTopTenDetailView` (line 154)

    **Step 6: Final verification grep**

    Run `grep -r "Monthly\|monthly" MrFunnyJokes/MrFunnyJokes/ --include="*.swift"` to verify zero remaining "Monthly" references in Swift source files.

    The ONLY acceptable remaining reference would be the `weeklyRankingsCollection = "weekly_rankings"` constant in FirestoreService.swift (which uses "weekly" not "monthly" -- this is accepted tech debt).
  </action>
  <verify>
    1. Run: `grep -ri "monthly" MrFunnyJokes/MrFunnyJokes/ --include="*.swift"` -- should return ZERO results
    2. Run: `grep "AllTimeRankingsViewModel" MrFunnyJokes/MrFunnyJokes/ViewModels/AllTimeRankingsViewModel.swift` -- should find the class declaration
    3. Run: `grep "AllTimeTopTenCarouselView" MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/AllTimeTopTenCarouselView.swift` -- should find the struct
    4. Run: `grep "AllTimeTopTenDetailView" MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/AllTimeTopTenDetailView.swift` -- should find the struct
    5. Run: `grep "All-Time Top 10" MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/AllTimeTopTenCarouselView.swift` -- should find the header text
    6. Run: `grep "All-Time Top 10" MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/AllTimeTopTenDetailView.swift` -- should find the nav title
    7. Run: `grep "dateRange\|monthDateRange\|formatDateRange" MrFunnyJokes/MrFunnyJokes/ViewModels/AllTimeRankingsViewModel.swift` -- should return ZERO results (removed)
    8. Run: `grep "dateRange" MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/AllTimeTopTenDetailView.swift` -- should return ZERO results (removed)
    9. Run: `grep "fetchWeeklyRankings" MrFunnyJokes/MrFunnyJokes/ViewModels/AllTimeRankingsViewModel.swift` -- should return ZERO results (renamed to fetchAllTimeRankings)
    10. Verify EmptyStateView is still defined and accessible: `grep "struct EmptyStateView" MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/AllTimeTopTenDetailView.swift` -- should find it (MeView depends on this)
  </verify>
  <done>
    All "Monthly" references replaced with "All-Time" across all Swift source files. AllTimeRankingsViewModel has no date range properties. AllTimeTopTenDetailView shows no date subtitle. All UI labels show "All-Time Top 10". Zero grep hits for "Monthly" or "monthly" in Swift source.
  </done>
</task>

</tasks>

<verification>
Phase-level verification after both tasks complete:

1. **No Monthly references:** `grep -ri "monthly" MrFunnyJokes/MrFunnyJokes/ --include="*.swift"` returns zero results
2. **All-Time labels present:** `grep -r "All-Time Top 10" MrFunnyJokes/MrFunnyJokes/ --include="*.swift"` returns hits in carousel and detail views
3. **Data source correct:** `grep "all_time" MrFunnyJokes/MrFunnyJokes/Services/FirestoreService.swift` returns the document ID
4. **Model compatible:** `grep "weekStart: Date?" MrFunnyJokes/MrFunnyJokes/Models/FirestoreModels.swift` returns the optional declaration
5. **No broken imports:** `grep "MonthlyRankingsViewModel\|MonthlyTopTenCarouselView\|MonthlyTopTenDetailView" MrFunnyJokes/MrFunnyJokes/ -r --include="*.swift"` returns zero results
6. **getCurrentWeekId preserved:** `grep "getCurrentWeekId" MrFunnyJokes/MrFunnyJokes/Services/FirestoreService.swift` returns hits (used by logRatingEvent)
7. **EmptyStateView preserved:** `grep "struct EmptyStateView" MrFunnyJokes/MrFunnyJokes/Views/AllTimeTopTen/AllTimeTopTenDetailView.swift` returns the definition
8. **pbxproj clean:** `grep "Monthly" MrFunnyJokes/MrFunnyJokes.xcodeproj/project.pbxproj` returns zero results
9. **File structure correct:** AllTimeTopTen/ folder contains AllTimeTopTenCarouselView.swift, AllTimeTopTenDetailView.swift, RankedJokeCard.swift
</verification>

<success_criteria>
- All user-visible text shows "All-Time Top 10" (headers, navigation titles)
- Rankings data reads from weekly_rankings/all_time Firestore document
- No date range subtitle displayed in detail view
- Zero "Monthly" references in any .swift file
- All file/folder names use AllTime naming convention
- pbxproj references updated to match filesystem
- EmptyStateView still accessible to MeView
- logRatingEvent() still functional (getCurrentWeekId preserved)
</success_criteria>

<output>
After completion, create `.planning/phases/16-all-time-leaderboard-ui/16-01-SUMMARY.md`
</output>
