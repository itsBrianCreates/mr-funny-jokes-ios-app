---
phase: 18-me-tab-saved-jokes
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - MrFunnyJokes/MrFunnyJokes/Views/MeView.swift
autonomous: true

must_haves:
  truths:
    - "Saved joke cards in MeView show a laughing emoji when the joke is rated Hilarious"
    - "Saved joke cards in MeView show a melting emoji when the joke is rated Horrible"
    - "Saved joke cards with no rating show no emoji indicator"
    - "The rating indicator appears at the trailing edge of the metadata row, matching JokeCardView layout"
  artifacts:
    - path: "MrFunnyJokes/MrFunnyJokes/Views/MeView.swift"
      provides: "Rating indicator in saved joke cards"
      contains: "CompactRatingView"
  key_links:
    - from: "MrFunnyJokes/MrFunnyJokes/Views/MeView.swift"
      to: "CompactRatingView (in GrainOMeterView.swift)"
      via: "Direct usage in jokeCard(for:) HStack"
      pattern: "CompactRatingView\\(rating:"
    - from: "MeView jokeCard"
      to: "Joke.userRating"
      via: "Property access on Joke model"
      pattern: "joke\\.userRating"
---

<objective>
Add Hilarious/Horrible rating indicator to saved joke cards in MeView.

Purpose: Complete the final phase 18 requirement (METB-03) so each saved joke row in the Me tab displays the user's rating when one exists. Three of four METB requirements were already satisfied in Phase 17-02 -- this plan addresses the sole remaining one.

Output: MeView.swift updated with CompactRatingView in the jokeCard bottom metadata row.
</objective>

<execution_context>
@/Users/brianvanaski/.claude/get-shit-done/workflows/execute-plan.md
@/Users/brianvanaski/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@MrFunnyJokes/MrFunnyJokes/Views/MeView.swift
@MrFunnyJokes/MrFunnyJokes/Views/GrainOMeterView.swift
@MrFunnyJokes/MrFunnyJokes/Views/JokeCardView.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add CompactRatingView to MeView jokeCard metadata row</name>
  <files>MrFunnyJokes/MrFunnyJokes/Views/MeView.swift</files>
  <action>
In `MeView.swift`, locate the `jokeCard(for:)` method's bottom metadata `HStack(spacing: 8)` (around line 102). This HStack currently contains the character indicator and category label. Add a `Spacer()` and conditional `CompactRatingView` at the trailing edge, exactly matching the pattern used in `JokeCardView.swift` lines 70-74.

Current code to modify (the closing brace of the HStack around line 112):
```swift
                HStack(spacing: 8) {
                    if let character = jokeCharacter(for: joke) {
                        CharacterIndicatorView(character: character)
                    }
                    HStack(spacing: 4) {
                        Image(systemName: joke.category.icon)
                        Text(joke.category.rawValue)
                    }
                    .font(.caption)
                    .foregroundStyle(.secondary)
                }
```

Replace with:
```swift
                HStack(spacing: 8) {
                    if let character = jokeCharacter(for: joke) {
                        CharacterIndicatorView(character: character)
                    }
                    HStack(spacing: 4) {
                        Image(systemName: joke.category.icon)
                        Text(joke.category.rawValue)
                    }
                    .font(.caption)
                    .foregroundStyle(.secondary)

                    Spacer()

                    if let rating = joke.userRating {
                        CompactRatingView(rating: rating)
                    }
                }
```

Key points:
- The `Spacer()` pushes the rating indicator to the trailing edge
- The `if let` guard ensures no indicator appears for unrated jokes
- `CompactRatingView` already handles rating values (5 = laughing emoji, 1 = melting emoji, other = EmptyView)
- Do NOT import anything new -- CompactRatingView is defined in GrainOMeterView.swift which is already in the same target
- Do NOT modify any other part of MeView
- Do NOT add `.animation()` modifiers (per CLAUDE.md animation pitfall rules)
  </action>
  <verify>
Build the project with `xcodebuild build -scheme MrFunnyJokes -destination 'platform=iOS Simulator,name=iPhone 16' -quiet 2>&1 | tail -5` and confirm zero errors. Then verify the change by reading MeView.swift and confirming CompactRatingView appears inside the jokeCard HStack with a preceding Spacer.
  </verify>
  <done>
MeView's jokeCard(for:) method renders CompactRatingView at the trailing edge of the bottom metadata row, showing laughing emoji for Hilarious-rated jokes, melting emoji for Horrible-rated jokes, and nothing for unrated jokes. The project builds without errors.
  </done>
</task>

</tasks>

<verification>
1. MeView.swift contains `CompactRatingView(rating:` inside the `jokeCard(for:)` method
2. A `Spacer()` precedes the CompactRatingView in the HStack
3. The CompactRatingView is guarded by `if let rating = joke.userRating`
4. Project builds without errors
5. No other files were modified
</verification>

<success_criteria>
- METB-03 implemented: saved joke rows display Hilarious/Horrible indicator when the user has rated that joke
- Rating indicator layout matches JokeCardView pattern (trailing edge of metadata HStack)
- Unrated saved jokes show no indicator
- Clean build with no warnings or errors related to the change
</success_criteria>

<output>
After completion, create `.planning/phases/18-me-tab-saved-jokes/18-01-SUMMARY.md`
</output>
