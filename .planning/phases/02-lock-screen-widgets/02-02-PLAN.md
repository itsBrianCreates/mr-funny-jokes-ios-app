---
phase: 02-lock-screen-widgets
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can add circular widget to lock screen via widget gallery"
    - "User can add rectangular widget to lock screen via widget gallery"
    - "User can add inline widget to lock screen via widget gallery"
    - "Circular widget displays character avatar clearly in vibrant mode"
    - "Rectangular widget shows character name and joke text legibly"
    - "Inline widget shows character and joke text without overflow"
    - "Tapping any lock screen widget opens app to home tab"
  artifacts: []
  key_links:
    - from: "Lock screen widget"
      to: "Main app home tab"
      via: "Widget tap -> deep link"
      pattern: "mrfunnyjokes://home"
---

<objective>
Verify lock screen widget implementation on physical device with real lock screen vibrant mode rendering.

Purpose: Simulator does not accurately reflect vibrant mode (RESEARCH.md pitfall #1). Physical device testing is required to confirm widgets look correct and function properly.

Output: Human verification that all three lock screen widget types display correctly and deep linking works.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-lock-screen-widgets/02-01-SUMMARY.md
@.planning/phases/02-lock-screen-widgets/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build and install on physical device</name>
  <files>None - build and deploy</files>
  <action>
1. Ensure physical iPhone is connected and trusted
2. Build and run on device:
   ```
   xcodebuild -project MrFunnyJokes.xcodeproj -scheme MrFunnyJokes -destination 'platform=iOS,name=iPhone' build
   ```
   Or use Xcode GUI: Product > Run with connected device selected.

3. Open the app once to ensure Joke of the Day data is loaded into SharedStorageService (widgets need this data).

4. If the app doesn't have a current Joke of the Day saved, navigate to the home tab to trigger loading.

Note: The widget extension is automatically installed when the main app is installed.
  </action>
  <verify>App launches on physical device and home tab shows current Joke of the Day</verify>
  <done>App is installed on physical device with Joke of the Day data available for widgets</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Three lock screen widget types (circular, rectangular, inline) using Joke of the Day content with proper vibrant mode handling</what-built>
  <how-to-verify>
**Adding Lock Screen Widgets:**
1. Lock your iPhone
2. Long-press on the lock screen to enter edit mode
3. Tap "Customize" and select "Lock Screen"
4. Tap an empty widget slot (above or below the time)
5. Scroll to find "Joke of the Day" in the widget gallery
6. You should see three size options: circular, rectangular, and inline

**Verify Circular Widget (WIDGET-01):**
1. Add the circular widget to the lock screen
2. Confirm: Character avatar is visible and centered
3. Confirm: Avatar is appropriately desaturated (vibrant mode) but still recognizable
4. Confirm: Widget has translucent circular background

**Verify Rectangular Widget (WIDGET-02):**
1. Add the rectangular widget to the lock screen
2. Confirm: Character name appears at top (e.g., "Mr. Funny")
3. Confirm: Joke setup text appears below, truncating with ellipsis if too long
4. Confirm: Text is legible against lock screen wallpaper

**Verify Inline Widget (WIDGET-03):**
1. Add the inline widget (appears below the date)
2. Confirm: Text shows format "Mr. Funny: Why did the..." or similar
3. Confirm: Text does not overflow or look broken

**Verify Tap Behavior (all widgets):**
1. Tap each widget type
2. Confirm: App opens to the home tab where Joke of the Day is displayed

**Verify Vibrant Mode (WIDGET-04):**
1. Try with both light and dark wallpapers if possible
2. Confirm: All widgets remain legible regardless of wallpaper
3. Confirm: Content has proper contrast in vibrant mode
  </how-to-verify>
  <resume-signal>
If all widgets work correctly: Type "approved"

If issues found: Describe what's wrong (e.g., "Circular avatar is completely white/invisible", "Rectangular text overlaps", "Tap doesn't open app")
  </resume-signal>
</task>

</tasks>

<verification>
1. App successfully installed on physical device
2. User confirmed circular widget displays correctly in vibrant mode
3. User confirmed rectangular widget shows character name + setup text
4. User confirmed inline widget shows text without overflow
5. User confirmed tapping widgets opens app to home tab
6. User confirmed widgets remain legible on various wallpapers
</verification>

<success_criteria>
- All three lock screen widget types appear in iOS widget gallery
- Each widget displays appropriate content per CONTEXT.md decisions:
  - Circular: character avatar only
  - Rectangular: character name + joke setup
  - Inline: "Character: joke text" format
- All widgets handle vibrant mode rendering correctly (legible, not washed out)
- Tap action launches app to home tab for all widget types
</success_criteria>

<output>
After completion, create `.planning/phases/02-lock-screen-widgets/02-02-SUMMARY.md`
</output>
